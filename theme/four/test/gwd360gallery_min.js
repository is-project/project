(function(){"use strict";var k=function(a){return"gwd-page"==a.tagName.toLowerCase()||"gwd-page"==a.getAttribute("is")},l=function(a){if(k(a))return a;for(;a&&9!=a.nodeType;)if((a=a.parentElement)&&k(a))return a;return null};var m=function(a){a=a.trim();return window.Enabler?Enabler.getUrl(a):a};var n=function(a){setTimeout(a,0)};var p=function(a,b,c){var d;c?(d=document.createEvent("CustomEvent"),d.initCustomEvent(a,!0,!0,c)):(d=document.createEvent("Event"),d.initEvent(a,!0,!0));b.dispatchEvent(d);return d},q=function(a,b){var c=function(d){a.removeEventListener("attached",c);b(d)};a.addEventListener("attached",c)};var r=["-ms-","-moz-","-webkit-",""];var t=function(a){var b=document.createElement("img","gwd-image");b.setAttribute("source",a);return b},u=function(a){var b=[];if(a){a=a.split(",");for(var c=0;c<a.length;++c)b.push(t(m(a[c])))}return b},v=function(a,b,c){p(b,a,{id:c||a.currentIndex})},w=function(a,b){return(a%b+b)%b};document.registerElement&&document.registerElement("gwd-360gallery",{prototype:Object.create(HTMLElement.prototype,{createdCallback:{value:function(){this.i=!1;this.d=null;this.a=0;this.s=1;this.b=-1;this.q=0;this.c=[];var a=document.createElement("gwd-gesture");a.className="gesture";this.e=a;this.o=this.onTrackStart_.bind(this);this.n=this.onTrack_.bind(this);this.m=this.onTap_.bind(this);this.k=p.bind(null,"firstinteraction",this);this.r=this.onFramesLoad_.bind(this);this.h=[];this.l=0;this.f=-1;
this.g=null;this.p=this.hasAttribute("images");this.j=null},enumerable:!0},attachedCallback:{value:function(){this.e.addEventListener("trackstart",this.o,!1);this.e.addEventListener("track",this.n,!1);this.e.addEventListener("tap",this.m,!1);if("function"==typeof this.gwdLoad){var a=l(this),b="function"==typeof this.gwdIsLoaded,c=a&&"function"==typeof a.gwdIsLoaded;if(!a||c&&a.gwdIsLoaded())b&&this.gwdIsLoaded()||this.gwdLoad()}},enumerable:!0},detachedCallback:{value:function(){this.e.removeEventListener("trackstart",
this.o,!1);this.e.removeEventListener("track",this.n,!1);this.e.removeEventListener("tap",this.m,!1);-1!=this.f&&(this.displayFrame_(this.f),this.haltStepping_())},enumerable:!0},goToFrame:{value:function(a,b,c){this.haltStepping_();if(0<a&&a<=this.a){var d=w(a-1,this.a);b=b||"slide";c||(c=this.b,c=d>c==this.a/2>Math.abs(d-c)?"forwards":"backwards");v(this,"frameactivated",a);this.stepToFrame_(this.b,d,b,c,300)}},enumerable:!0},rotateOnce:{value:function(a,b){this.haltStepping_();var c=a&&b&&"string"==
typeof a&&"number"==typeof b,d=(c?a:b)||"forwards",f=(c?b:a)||300*this.a;if(1<this.a){var e=this.b,g=w(this.b+("left"==d||"backwards"==d?-1:1),this.a);n(function(){this.stepToFrame_(g,e,"slide",d,f/this.a,!0)}.bind(this))}},enumerable:!0},gwdIsLoaded:{value:function(){return this.i},enumerable:!0},gwdLoad:{value:function(){if(!this.i&&!this.d){var a;if(this.p)a=u(this.getAttribute("images"));else{a=this.childNodes;for(var b=[],c=0,d=a.length;c<d;c++){var f=a[c];f.nodeType==Node.ELEMENT_NODE&&b.push(f)}a=
b}this.c=a;this.loadFrames_()}},enumerable:!0},loadFrames_:{value:function(){for(;this.firstChild;)this.removeChild(this.firstChild);this.d&&this.d.removeEventListener("pageload",this.r,!1);for(var a=this.c,b=document.createElement("div","gwd-page"),c,d=0;d<a.length;++d){for(var f=c=a[d],e=void 0,g=void 0,h=0;h<r.length;++h)e=r[h]+"user-select",g="none",f.style.setProperty(e,g);c.classList.add("frame");b.appendChild(c)}q(b,b.gwdLoad.bind(b));this.d=b;b.addEventListener("pageload",this.r,!1);this.appendChild(b);
this.appendChild(this.e)},enumerable:!1},onFramesLoad_:{value:function(a){if(this.d===a.target){a=this.c;for(var b=this.clientWidth,c=this.clientHeight,d,f=b/c,e,g,h=0;h<a.length;++h)d=a[h],"img"==d.tagName.toLowerCase()&&(e=d.offsetWidth/d.offsetHeight,f>e?(g=c*e,e=c):(g=b,e=b/e),d.style.width=g+"px",d.style.height=e+"px");this.i=!0;this.removeChild(this.d);this.a=this.c.length;this.h=[];this.l=this.a;this.displayFrame_(0);this.d=null;p("imagesloaded",this);p("allframesloaded",this);this.hasAttribute("autoplay")&&
setTimeout(this.rotateOnce.bind(this),0);p("ready",this)}},enumerable:!1},attributeChangedCallback:{value:function(a){"images"==a&&(this.haltStepping_(),this.p=!0,this.a=0,this.b=-1,this.c=u(this.getAttribute(a)),this.loadFrames_())},enumerable:!0},onTrackStart_:{value:function(){this.haltStepping_();this.a&&(this.q=this.b)},enumerable:!1},onTrack_:{value:function(a){this.a&&(this.k&&(this.k(),this.k=null),a=w(this.q+Math.round(a.dx/50),this.a),this.b!=a&&this.c[a]&&(v(this,"frameactivated",a+1),
this.displayFrame_(a)))},enumerable:!1},onTap_:{value:function(){this.a&&v(this,"frametap")},enumerable:!1},displayFrame_:{value:function(a){if(this.b!=a&&this.c[a]){this.b=a;var b=this.j;this.j=this.c[a];this.appendChild(this.j);b&&this.removeChild(b);v(this,"frameshown");this.h[a]||(this.h[a]=!0,--this.l||p("allframesviewed",this))}},enumerable:!1},stepToFrame_:{value:function(a,b,c,d,f,e){"none"==c&&(a=b);this.displayFrame_(a);e&&v(this,"frameactivated",a+1);a!=b?(this.f=b,a=w(a+("left"==d||"backwards"==
d?-1:1),this.a),this.g=setTimeout(this.stepToFrame_.bind(this,a,b,c,d,f,e),f)):(this.g=null,this.f=-1)},enumerable:!1},haltStepping_:{value:function(){-1!=this.f&&(clearTimeout(this.g),this.g=null,this.f=-1,v(this,"frameactivated",this.b))}},currentIndex:{enumerable:!0,get:function(){return this.a?this.b+1:void 0}},getFrame:{value:function(a){return this.c[a-1]},enumerable:!0},goForwards:{value:function(){this.goToFrame(this.b+2,"none")},enumerable:!0},goBackwards:{value:function(){this.goToFrame(this.b,
"none")},enumerable:!0},frameSnapInterval:{get:function(){return this.s}},frameCount:{get:function(){return this.a}}})});})()
